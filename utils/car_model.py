import numpy as np
import copy

# keypoints in carla coordinate system (left hand rule)
# x: front, y: right, z: up
world_car = {
    "vehicle.audi.a2": [
        [0.4, 0.5, 1.5], [0.4, -0.5, 1.5], [1.6, 0.6, 0.8], [1.6, -0.6, 0.8],
        [1.7, 0.8, 0.3], [1.7, -0.8, 0.3], [-0.4, -0.5, 1.5], [1.2, -0.8, 0.3],
        [-1.3, -0.8, 0.3], [-1.7, -0.7, 0.7], [-1.6, -0.5, 1.3], [-1.6, 0.5, 1.3],
        [-1.7, -0.6, 0.9], [-1.7, 0.6, 0.9], [-1.7, -0.7, 0.3], [-1.7, 0.7, 0.3],
        [-0.4, 0.5, 1.5], [-1.7, 0.7, 0.7], [-1.3, 0.8, 0.3], [1.2, 0.8, 0.3],
        [-1.7, -0.3, 0.9], [-1.7, 0.3, 0.9], [0.6, -0.8, 1.1], [0.6, 0.8, 1.1]
    ],
    "vehicle.citroen.c3": [
        [0.2, 0.5, 1.5], [0.2, -0.5, 1.5], [1.7, 0.7, 0.8], [1.7, -0.7, 0.8],
        [1.7, 0.8, 0.3], [1.7, -0.8, 0.3], [-0.4, -0.5, 1.5], [1.3, -0.8, 0.3],
        [-1.4, -0.8, 0.3], [-1.8, -0.7, 0.7], [-1.4, -0.5, 1.5], [-1.4, 0.5, 1.5],
        [-1.6, -0.6, 1.2], [-1.6, 0.6, 1.2], [-1.9, -0.8, 0.3], [-1.9, 0.8, 0.3],
        [-0.4, 0.5, 1.5], [-1.8, 0.7, 0.7], [-1.4, 0.8, 0.3], [1.3, 0.8, 0.3],
        [-1.9, -0.3, 0.8], [-1.9, 0.3, 0.8], [0.6, -0.8, 1.1], [0.6, 0.8, 1.1]
    ],
    "vehicle.chevrolet.impala": [
        [0.5, 0.7, 1.4], [0.5, -0.7, 1.4], [2.5, 0.7, 0.6], [2.5, -0.7, 0.6],
        [2.5, 0.8, 0.3], [2.5, -0.8, 0.3], [-0.2, -0.6, 1.4], [1.6, -0.8, 0.3],
        [-1.3, -0.8, 0.3], [-2.5, -0.7, 0.6], [-1.1, -0.5, 1.3], [-1.1, 0.5, 1.3],
        [-2.5, -0.7, 0.8], [-2.5, 0.7, 0.8], [-2.5, -0.7, 0.3], [-2.5, 0.7, 0.3],
        [-0.2, 0.6, 1.4], [-2.5, 0.7, 0.6], [-1.3, 0.8, 0.3], [1.6, 0.8, 0.3],
        [-2.5, -0.2, 0.7], [-2.5, 0.2, 0.7], [1.0, -0.9, 0.9], [1.0, 0.9, 0.9]
    ],
    "vehicle.dodge.charger_police_2020": [
        [0.3, 0.6, 1.4], [0.3, -0.6, 1.4], [2.2, 0.7, 0.7], [2.2, -0.7, 0.7],
        [2.2, 0.8, 0.3], [2.2, -0.8, 0.3], [-0.3, -0.7, 1.4], [1.6, -0.8, 0.3],
        [-1.4, -0.8, 0.3], [-2.3, -0.7, 0.8], [-1.0, -0.6, 1.4], [-1.0, 0.6, 1.4],
        [-2.3, -0.7, 1.0], [-2.3, 0.7, 1.0], [-2.3, -0.7, 0.3], [-2.3, 0.7, 0.3],
        [-0.3, 0.7, 1.4], [-2.3, 0.7, 0.8], [-1.4, 0.8, 0.3], [1.6, 0.8, 0.3],
        [-2.5, -0.3, 0.6], [-2.5, 0.3, 0.6], [0.6, -1.0, 1.1], [0.6, 1.0, 1.1]
    ],
    "vehicle.micro.microlino": [
        [0.3, 0.4, 1.3], [0.3, -0.4, 1.3], [0.6, 0.7, 0.9], [0.6, -0.7, 0.9],
        [1.0, 0.6, 0.2], [1.0, -0.6, 0.2], [-0.1, -0.4, 1.3], [0.7, -0.6, 0.2],
        [-0.9, -0.4, 0.2], [-1.0, -0.4, 0.7], [-0.5, -0.4, 1.2], [-0.5, 0.4, 1.2],
        [-1.1, -0.4, 0.6], [-1.1, 0.4, 0.6], [-1.1, -0.4, 0.2], [-1.1, 0.4, 0.2],
        [-0.1, 0.4, 1.3], [-1.0, 0.4, 0.7], [-0.9, 0.4, 0.2], [0.7, 0.6, 0.2],
        [-1.1, -0.2, 0.3], [-1.1, 0.2, 0.3], [0.5, -0.7, 0.9], [0.5, 0.7, 0.9]
    ],
    "vehicle.dodge.charger_police": [
        [0.3, 0.6, 1.4], [0.3, -0.6, 1.4], [2.2, 0.7, 0.7], [2.2, -0.7, 0.7],
        [2.2, 0.8, 0.3], [2.2, -0.8, 0.3], [-0.3, -0.7, 1.4], [1.6, -0.8, 0.3],
        [-1.4, -0.8, 0.3], [-2.3, -0.7, 0.8], [-1.0, -0.6, 1.4], [-1.0, 0.6, 1.4],
        [-2.3, -0.7, 1.0], [-2.3, 0.7, 1.0], [-2.3, -0.7, 0.3], [-2.3, 0.7, 0.3],
        [-0.3, 0.7, 1.4], [-2.3, 0.7, 0.8], [-1.4, 0.8, 0.3], [1.6, 0.8, 0.3],
        [-2.5, -0.3, 0.6], [-2.5, 0.3, 0.6], [0.6, -1.0, 1.1], [0.6, 1.0, 1.1]
    ],
    "vehicle.audi.tt": [
        [0.1, 0.7, 1.4], [0.1, -0.7, 1.4], [1.8, 0.7, 0.7], [1.8, -0.7, 0.7],
        [1.9, 0.9, 0.3], [1.9, -0.9, 0.3], [-0.4, -0.5, 1.4], [1.3, -0.9, 0.3],
        [-1.4, -0.9, 0.3], [-1.9, -0.8, 0.5], [-0.9, -0.5, 1.3], [-0.9, 0.5, 1.3],
        [-2.0, -0.6, 0.8], [-2.0, 0.6, 0.8], [-2.0, -0.9, 0.3], [-2.0, 0.9, 0.3],
        [-0.4, 0.5, 1.4], [-1.9, 0.8, 0.5], [-1.4, 0.9, 0.3], [1.3, 0.9, 0.3],
        [-2.0, -0.4, 0.7], [-2.0, 0.4, 0.7], [0.4, -0.9, 1.1], [0.4, 0.9, 1.1]
    ],
    "vehicle.jeep.wrangler_rubicon": [
        [0.2, 0.6, 1.7], [0.2, -0.6, 1.7], [1.6, 0.4, 1.0], [1.6, -0.4, 1.0],
        [1.7, 0.8, 0.3], [1.7, -0.8, 0.3], [-0.7, -0.6, 1.8], [1.3, -0.8, 0.3],
        [-1.0, -0.8, 0.3], [-1.6, -0.7, 0.6], [-1.4, -0.6, 1.8], [-1.4, 0.6, 1.8],
        [-1.6, -0.7, 1.0], [-1.6, 0.7, 1.0], [-1.6, -0.7, 0.3], [-1.6, 0.7, 0.3],
        [-0.7, 0.6, 1.8], [-1.6, 0.7, 0.6], [-1.0, 0.8, 0.3], [1.3, 0.8, 0.3],
        [-1.6, -0.4, 0.8], [-1.6, 0.4, 0.8], [0.3, -0.8, 1.3], [0.3, 0.8, 1.3]
    ],
    "vehicle.mercedes.coupe": [
        [0.2, 0.6, 1.4], [0.2, -0.6, 1.4], [2.2, 0.8, 0.7], [2.2, -0.8, 0.7],
        [2.3, 1.0, 0.2], [2.3, -1.0, 0.2], [-0.5, -0.6, 1.5], [1.8, -1.0, 0.2],
        [-1.5, -1.0, 0.2], [-2.4, -0.5, 0.8], [-1.2, -0.5, 1.4], [-1.2, 0.5, 1.4],
        [-2.2, -0.7, 1.0], [-2.2, 0.7, 1.0], [-2.4, -0.9, 0.2], [-2.4, 0.9, 0.2],
        [-0.5, 0.6, 1.5], [-2.4, 0.5, 0.8], [-1.5, 1.0, 0.2], [1.8, 1.0, 0.2],
        [-2.5, -0.4, 0.5], [-2.5, 0.4, 0.5], [0.5, -1.0, 1.0], [0.5, 1.0, 1.0]
    ],
    "vehicle.mercedes.coupe_2020": [
        [0.2, 0.6, 1.4], [0.2, -0.6, 1.4], [2.1, 0.7, 0.7], [2.1, -0.7, 0.7],
        [2.1, 0.9, 0.3], [2.1, -0.9, 0.3], [-0.4, -0.6, 1.4], [1.6, -0.9, 0.3],
        [-1.3, -0.9, 0.3], [-2.2, -0.5, 0.7], [-1.2, -0.6, 1.3], [-1.2, 0.6, 1.3],
        [-2.1, -0.6, 0.9], [-2.1, 0.6, 0.9], [-2.1, -0.6, 0.3], [-2.1, 0.6, 0.3],
        [-0.4, 0.6, 1.4], [-2.2, 0.5, 0.7], [-1.3, 0.9, 0.3], [1.6, 0.9, 0.3],
        [-2.2, -0.4, 0.5], [-2.2, 0.4, 0.5], [0.5, -0.9, 1.0], [0.5, 0.9, 1.0]
    ],
    "vehicle.dodge.charger_2020": [
        [0.3, 0.6, 1.4], [0.3, -0.6, 1.4], [2.2, 0.7, 0.7], [2.2, -0.7, 0.7],
        [2.2, 0.8, 0.3], [2.2, -0.8, 0.3], [-0.3, -0.6, 1.4], [1.6, -0.9, 0.3],
        [-1.4, -0.9, 0.3], [-2.4, -0.6, 0.8], [-1.0, -0.6, 1.4], [-1.0, 0.6, 1.4],
        [-2.3, -0.6, 0.9], [-2.3, 0.6, 0.9], [-2.3, -0.7, 0.3], [-2.3, 0.7, 0.3],
        [-0.3, 0.6, 1.4], [-2.4, 0.6, 0.8], [-1.4, 0.9, 0.3], [1.6, 0.9, 0.3],
        [-2.5, -0.3, 0.6], [-2.5, 0.3, 0.6], [0.6, -1.0, 1.1], [0.6, 1.0, 1.1]
    ],
    "vehicle.ford.ambulance": [
        [1.3, 0.7, 1.9], [1.3, -0.7, 1.9], [2.8, 0.7, 0.9], [2.8, -0.7, 0.9],
        [2.7, 0.8, 0.4], [2.7, -0.8, 0.4], [-0.4, -1.1, 2.4], [2.1, -1.0, 0.4],
        [-1.7, -1.0, 0.4], [-3.2, -1.0, 0.5], [-3.2, -1.1, 2.4], [-3.2, 1.1, 2.4],
        [-3.2, -0.9, 0.6], [-3.2, 0.9, 0.6], [-3.2, -1.1, 0.4], [-3.2, 1.1, 0.4],
        [-0.4, 1.1, 2.4], [-3.2, 1.0, 0.5], [-1.7, 1.0, 0.4], [2.1, 1.0, 0.4],
        [-3.2, -0.3, 0.5], [-3.2, 0.3, 0.5], [1.6, -1.2, 1.5], [1.6, 1.2, 1.5]
    ],
    "vehicle.lincoln.mkz_2020": [
        [0.3, 0.6, 1.4], [0.3, -0.6, 1.4], [2.2, 0.7, 0.7], [2.2, -0.7, 0.7],
        [2.2, 0.8, 0.3], [2.2, -0.8, 0.3], [-0.3, -0.6, 1.4], [1.5, -0.9, 0.3],
        [-1.4, -0.9, 0.3], [-2.3, -0.6, 0.8], [-1.0, -0.6, 1.4], [-1.0, 0.6, 1.4],
        [-2.2, -0.6, 0.9], [-2.2, 0.6, 0.9], [-2.2, -0.7, 0.3], [-2.2, 0.7, 0.3],
        [-0.3, 0.6, 1.4], [-2.3, 0.6, 0.8], [-1.4, 0.9, 0.3], [1.5, 0.9, 0.3],
        [-2.4, -0.4, 0.5], [-2.4, 0.4, 0.5], [0.7, -1.0, 1.0], [0.7, 1.0, 1.0]
    ],
    "vehicle.mini.cooper_s_2021": [
        [0.3, 0.6, 1.6], [0.3, -0.6, 1.6], [1.8, 0.8, 0.9], [1.8, -0.8, 0.9],
        [2.0, 1.0, 0.3], [2.0, -1.0, 0.3], [-0.7, -0.6, 1.6], [1.4, -1.0, 0.3],
        [-1.6, -0.8, 0.3], [-2.2, -0.7, 0.7], [-1.6, -0.6, 1.6], [-1.6, 0.6, 1.6],
        [-2.1, -0.8, 0.9], [-2.1, 0.8, 0.9], [-2.2, -0.9, 0.3], [-2.2, 0.9, 0.3],
        [-0.7, 0.6, 1.6], [-2.2, 0.7, 0.7], [-1.6, 0.8, 0.3], [1.4, 1.0, 0.3],
        [-2.2, -0.3, 0.9], [-2.2, 0.3, 0.9], [0.4, -1.0, 1.2], [0.4, 1.0, 1.2]
    ],
    "vehicle.toyota.prius": [
        [0.3, 0.6, 1.4], [0.3, -0.6, 1.4], [2.0, 0.7, 0.8], [2.0, -0.7, 0.8],
        [2.0, 0.8, 0.3], [2.0, -0.8, 0.3], [-0.3, -0.5, 1.5], [1.4, -0.9, 0.3],
        [-1.4, -0.9, 0.3], [-2.1, -0.6, 0.7], [-1.0, -0.5, 1.4], [-1.0, 0.5, 1.4],
        [-2.1, -0.6, 1.1], [-2.1, 0.6, 1.1], [-2.1, -0.6, 0.3], [-2.1, 0.6, 0.3],
        [-0.3, 0.5, 1.5], [-2.1, 0.6, 0.7], [-1.4, 0.9, 0.3], [1.4, 0.9, 0.3],
        [-2.1, -0.4, 0.8], [-2.1, 0.4, 0.8], [1.0, -0.9, 1.0], [1.0, 0.9, 1.0]
    ],
    "vehicle.ford.crown": [
        [0.5, 0.6, 1.3], [0.5, -0.6, 1.3], [2.5, 0.6, 0.6], [2.5, -0.6, 0.6],
        [2.6, 0.7, 0.3], [2.6, -0.7, 0.3], [-0.1, -0.5, 1.4], [1.8, -0.9, 0.3],
        [-1.2, -0.9, 0.3], [-2.3, -0.8, 0.7], [-1.0, -0.6, 1.4], [-1.0, 0.6, 1.4],
        [-2.3, -0.7, 0.8], [-2.3, 0.7, 0.8], [-2.3, -0.8, 0.3], [-2.3, 0.8, 0.3],
        [-0.1, 0.5, 1.4], [-2.3, 0.8, 0.7], [-1.2, 0.9, 0.3], [1.8, 0.9, 0.3],
        [-2.3, -0.4, 0.7], [-2.3, 0.4, 0.7], [0.8, -0.9, 1.0], [0.8, 0.9, 1.0]
    ],
    "vehicle.carlamotors.carlacola": [
        [2.2, 0.8, 2.0], [2.2, -0.8, 2.0], [2.5, 0.6, 0.7], [2.5, -0.6, 0.7],
        [2.5, 0.9, 0.4], [2.5, -0.9, 0.4], [0.7, -1.0, 2.4], [1.4, -1.1, 0.4],
        [-1.2, -1.3, 0.4], [-2.6, -1.2, 0.7], [-2.6, -1.2, 2.4], [-2.6, 1.2, 2.4],
        [-2.5, -0.9, 0.9], [-2.5, 0.9, 0.9], [-2.6, -1.2, 0.4], [-2.6, 1.2, 0.4],
        [0.7, 1.0, 2.4], [-2.6, 1.2, 0.7], [-1.2, 1.3, 0.4], [1.4, 1.1, 0.4],
        [-2.5, -0.3, 1.1], [-2.5, 0.3, 1.1], [2.2, -1.1, 1.7], [2.2, 1.1, 1.7]
    ],
    "vehicle.nissan.patrol_2021": [
        [0.6, 0.8, 1.9], [0.6, -0.8, 1.9], [2.4, 0.9, 1.0], [2.4, -0.9, 1.0],
        [2.6, 1.0, 0.4], [2.6, -1.0, 0.4], [-0.6, -0.7, 2.0], [1.8, -1.0, 0.4],
        [-1.5, -1.0, 0.4], [-2.5, -0.8, 0.9], [-2.3, -0.7, 2.0], [-2.3, 0.7, 2.0],
        [-2.5, -0.8, 1.2], [-2.5, 0.8, 1.2], [-2.6, -0.8, 0.4], [-2.6, 0.8, 0.4],
        [-0.6, 0.7, 2.0], [-2.5, 0.8, 0.9], [-1.5, 1.0, 0.4], [1.8, 1.0, 0.4],
        [-2.6, -0.3, 1.1], [-2.6, 0.3, 1.1], [0.8, -1.1, 1.5], [0.8, 1.1, 1.5]
    ],
    "vehicle.mercedes.sprinter": [
        [3.6, 1.4, 3.8], [3.6, -1.4, 3.8], [4.3, 1.4, 1.2], [4.3, -1.4, 1.2],
        [4.3, 1.5, 0.6], [4.3, -1.5, 0.6], [-1.0, -1.3, 4.1], [3.0, -1.5, 0.6],
        [-2.6, -1.5, 0.6], [-5.4, -1.5, 1.3], [-5.2, -1.3, 4.1], [-5.2, 1.3, 4.1],
        [-5.4, -1.3, 1.9], [-5.4, 1.3, 1.9], [-5.4, -1.6, 0.6], [-5.4, 1.6, 0.6],
        [-1.0, 1.3, 4.1], [-5.4, 1.5, 1.3], [-2.6, 1.5, 0.6], [3.0, 1.5, 0.6],
        [-5.4, -0.5, 0.7], [-5.4, 0.5, 0.7], [3.9, -1.9, 2.5], [3.9, 1.9, 2.5]
    ],
    "vehicle.audi.etron": [
        [0.4, 0.7, 1.5], [0.4, -0.7, 1.5], [2.1, 0.7, 0.8], [2.1, -0.7, 0.8],
        [2.2, 0.8, 0.4], [2.2, -0.8, 0.4], [-0.3, -0.6, 1.6], [1.5, -0.9, 0.4],
        [-1.4, -0.9, 0.4], [-2.2, -0.7, 0.8], [-1.6, -0.6, 1.5], [-1.6, 0.6, 1.5],
        [-2.1, -0.7, 1.0], [-2.1, 0.7, 1.0], [-2.2, -0.8, 0.4], [-2.2, 0.8, 0.4],
        [-0.3, 0.6, 1.6], [-2.2, 0.7, 0.8], [-1.4, 0.9, 0.4], [1.5, 0.9, 0.4],
        [-2.3, -0.4, 0.9], [-2.3, 0.4, 0.9], [0.5, -1.0, 1.1], [0.5, 1.0, 1.1]
    ],
    "vehicle.seat.leon": [
        [0.1, 0.5, 1.4], [0.1, -0.5, 1.4], [1.9, 0.6, 0.7], [1.9, -0.6, 0.7],
        [1.9, 0.8, 0.3], [1.9, -0.8, 0.3], [-0.6, -0.5, 1.4], [1.3, -0.8, 0.3],
        [-1.4, -0.8, 0.3], [-2.0, -0.7, 0.7], [-1.3, -0.5, 1.4], [-1.3, 0.5, 1.4],
        [-1.9, -0.6, 0.9], [-1.9, 0.6, 0.9], [-2.0, -0.7, 0.3], [-2.0, 0.7, 0.3],
        [-0.6, 0.5, 1.4], [-2.0, 0.7, 0.7], [-1.4, 0.8, 0.3], [1.3, 0.8, 0.3],
        [-2.1, -0.3, 0.5], [-2.1, 0.3, 0.5], [0.5, -0.8, 1.1], [0.5, 0.8, 1.1]
    ],
    "vehicle.volkswagen.t2_2021": [
        [1.6, 0.7, 1.9], [1.6, -0.7, 1.9], [2.1, 0.5, 0.7], [2.1, -0.5, 0.7],
        [2.1, 0.5, 0.3], [2.1, -0.5, 0.3], [-0.4, -0.7, 1.9], [1.3, -0.8, 0.3],
        [-1.3, -0.8, 0.3], [-2.0, -0.8, 0.5], [-1.9, -0.7, 1.9], [-1.9, 0.7, 1.9],
        [-2.1, -0.6, 0.7], [-2.1, 0.6, 0.7], [-2.0, -0.8, 0.3], [-2.0, 0.8, 0.3],
        [-0.4, 0.7, 1.9], [-2.0, 0.8, 0.5], [-1.3, 0.8, 0.3], [1.3, 0.8, 0.3],
        [-2.1, -0.3, 0.7], [-2.1, 0.3, 0.7], [1.8, -0.9, 1.4], [1.8, 0.9, 1.4]
    ],
    "vehicle.tesla.cybertruck": [
        [0.4, 0.7, 2.1], [0.4, -0.7, 2.1], [3.0, 0.9, 1.1], [3.0, -0.9, 1.1],
        [3.0, 0.9, 0.5], [3.0, -0.9, 0.5], [0.4, 0.7, 2.1], [2.2, -1.2, 0.5],
        [-1.9, -1.2, 0.5], [-3.0, -1.1, 0.9], [0.4, -0.7, 2.1], [0.4, 0.7, 2.1],
        [-3.1, -0.9, 1.6], [-3.1, 0.9, 1.6], [-3.1, -0.9, 0.5], [-3.1, 0.9, 0.5],
        [0.4, -0.7, 2.1], [-3.0, 1.1, 0.9], [-1.9, 1.2, 0.5], [2.2, 1.2, 0.5],
        [-3.1, -0.5, 0.8], [-3.1, 0.5, 0.8], [1.3, -1.0, 1.6], [1.3, 1.0, 1.6]
    ],
    "vehicle.lincoln.mkz_2017": [
        [0.3, 0.6, 1.4], [0.3, -0.6, 1.4], [2.2, 0.7, 0.7], [2.2, -0.7, 0.7],
        [2.2, 0.8, 0.3], [2.2, -0.8, 0.3], [-0.3, -0.6, 1.4], [1.5, -0.9, 0.3],
        [-1.4, -0.9, 0.3], [-2.3, -0.6, 0.8], [-1.0, -0.6, 1.4], [-1.0, 0.6, 1.4],
        [-2.2, -0.6, 0.9], [-2.2, 0.6, 0.9], [-2.2, -0.7, 0.3], [-2.2, 0.7, 0.3],
        [-0.3, 0.6, 1.4], [-2.3, 0.6, 0.8], [-1.4, 0.9, 0.3], [1.5, 0.9, 0.3],
        [-2.4, -0.4, 0.5], [-2.4, 0.4, 0.5], [0.7, -1.0, 1.0], [0.7, 1.0, 1.0]
    ],
    "vehicle.ford.mustang": [
        [0.2, 0.7, 1.2], [0.2, -0.7, 1.2], [2.2, 0.7, 0.7], [2.2, -0.7, 0.7],
        [2.2, 0.8, 0.3], [2.2, -0.8, 0.3], [-0.7, -0.7, 1.2], [1.6, -0.9, 0.3],
        [-1.3, -0.9, 0.3], [-2.3, -0.9, 0.5], [-0.9, -0.7, 1.2], [-0.9, 0.7, 1.2],
        [-2.3, -0.6, 0.7], [-2.3, 0.6, 0.7], [-2.2, -0.8, 0.3], [-2.2, 0.8, 0.3],
        [-0.7, 0.7, 1.2], [-2.3, 0.9, 0.5], [-1.3, 0.9, 0.3], [1.6, 0.9, 0.3],
        [-2.2, -0.4, 0.4], [-2.2, 0.4, 0.4], [0.2, -0.9, 1.0], [0.2, 0.9, 1.0]
    ],
    "vehicle.carlamotors.firetruck": [
        [3.5, 1.3, 3.2], [3.5, -1.3, 3.2], [3.9, 1.0, 0.7], [3.9, -1.0, 0.7],
        [3.9, 1.4, 0.5], [3.9, -1.4, 0.5], [1.8, -1.2, 3.3], [2.3, -1.3, 0.5],
        [-2.7, -1.3, 0.5], [-4.3, -1.3, 0.5], [-4.3, -1.3, 3.2], [-4.3, 1.3, 3.2],
        [-4.3, -1.3, 0.6], [-4.3, 1.3, 0.6], [-4.3, -1.4, 0.4], [-4.3, 1.4, 0.4],
        [1.8, 1.2, 3.3], [-4.3, 1.3, 0.5], [-2.7, 1.3, 0.5], [2.3, 1.3, 0.5],
        [-4.3, -0.6, 0.6], [-4.3, 0.6, 0.6], [3.3, -1.5, 2.3], [3.3, 1.5, 2.3]
    ],
    "vehicle.volkswagen.t2": [
        [1.6, 0.7, 1.8], [1.6, -0.7, 1.8], [2.2, 0.6, 0.9], [2.2, -0.6, 0.9],
        [2.1, 0.8, 0.4], [2.1, -0.8, 0.4], [-0.1, -0.7, 1.9], [1.2, -0.8, 0.4],
        [-1.3, -0.8, 0.4], [-2.1, -0.8, 0.5], [-1.8, -0.6, 1.9], [-1.8, 0.6, 1.9],
        [-2.2, -0.7, 0.8], [-2.2, 0.7, 0.8], [-2.2, -0.7, 0.4], [-2.2, 0.7, 0.4],
        [-0.1, 0.7, 1.9], [-2.1, 0.8, 0.5], [-1.3, 0.8, 0.4], [1.2, 0.8, 0.4],
        [-2.2, -0.3, 0.8], [-2.2, 0.3, 0.8], [1.5, -1.0, 1.5], [1.5, 1.0, 1.5]
    ],
    "vehicle.mitsubishi.fusorosa": [
        [3.5, 1.6, 3.9], [3.5, -1.4, 3.9], [4.4, 1.6, 1.2], [4.4, -1.4, 1.2],
        [4.2, 1.6, 0.6], [4.2, -1.5, 0.6], [-0.1, -1.3, 4.2], [3.0, -1.5, 0.6],
        [-2.6, -1.5, 0.6], [-5.4, -1.5, 1.3], [-5.2, -1.3, 4.1], [-5.2, 1.3, 4.1],
        [-5.4, -1.3, 2.0], [-5.4, 1.3, 2.0], [-5.4, -1.6, 0.6], [-5.4, 1.6, 0.6],
        [-0.1, 1.4, 4.2], [-5.4, 1.5, 1.3], [-2.6, 1.5, 0.6], [3.0, 1.5, 0.6],
        [-5.4, -0.6, 0.7], [-5.4, 0.6, 0.7], [3.9, -1.9, 2.6], [4.6, 1.9, 2.6]
    ],
    "vehicle.tesla.model3": [
        [0.2, 0.7, 1.4], [0.2, -0.7, 1.4], [2.1, 0.7, 0.7], [2.1, -0.7, 0.7],
        [2.2, 0.8, 0.3], [2.2, -0.8, 0.3], [-0.3, -0.6, 1.4], [1.6, -0.9, 0.3],
        [-1.4, -0.9, 0.3], [-2.2, -0.7, 0.6], [-1.6, -0.6, 1.3], [-1.6, 0.6, 1.3],
        [-2.2, -0.6, 0.9], [-2.2, 0.6, 0.9], [-2.2, -0.6, 0.3], [-2.2, 0.6, 0.3],
        [-0.3, 0.6, 1.4], [-2.2, 0.7, 0.6], [-1.4, 0.9, 0.3], [1.6, 0.9, 0.3],
        [-2.3, -0.4, 0.8], [-2.3, 0.4, 0.8], [0.7, -1.0, 1.0], [0.7, 1.0, 1.0]
    ],
    "vehicle.bmw.grandtourer": [
        [0.2, 0.7, 1.5], [0.2, -0.7, 1.5], [2.0, 0.8, 0.7], [2.0, -0.8, 0.7],
        [2.0, 1.0, 0.3], [2.0, -1.0, 0.3], [-0.4, -0.7, 1.5], [1.5, -1.1, 0.3],
        [-1.4, -1.1, 0.3], [-2.2, -0.8, 0.5], [-1.9, -0.7, 1.4], [-1.9, 0.7, 1.4],
        [-2.1, -0.8, 0.9], [-2.1, 0.8, 0.9], [-2.2, -0.9, 0.3], [-2.2, 0.9, 0.3],
        [-0.4, 0.7, 1.5], [-2.2, 0.8, 0.5], [-1.4, 1.1, 0.3], [1.5, 1.1, 0.3],
        [-2.2, -0.5, 0.8], [-2.2, 0.5, 0.8], [0.6, -1.0, 1.0], [0.6, 1.0, 1.0]
    ],
    "vehicle.nissan.patrol": [
        [0.3, 0.5, 1.7], [0.3, -0.5, 1.7], [2.0, 0.7, 1.0], [2.0, -0.7, 1.0],
        [2.0, 0.9, 0.4], [2.0, -0.9, 0.4], [-0.7, -0.5, 1.7], [1.5, -0.9, 0.4],
        [-1.4, -0.9, 0.4], [-2.1, -0.9, 0.7], [-1.8, -0.5, 1.7], [-1.8, 0.5, 1.7],
        [-2.1, -0.8, 1.0], [-2.1, 0.8, 1.0], [-2.2, -0.8, 0.4], [-2.2, 0.8, 0.4],
        [-0.7, 0.5, 1.7], [-2.1, 0.9, 0.7], [-1.4, 0.9, 0.4], [1.5, 0.9, 0.4],
        [-2.1, -0.7, 0.9], [-2.1, -0.3, 0.9], [0.6, -0.8, 1.3], [0.6, 0.8, 1.3]
    ],
    "vehicle.nissan.micra": [
        [0.1, 0.5, 1.5], [0.1, -0.5, 1.5], [1.5, 0.6, 0.9], [1.5, -0.6, 0.9],
        [1.6, 0.7, 0.3], [1.6, -0.7, 0.3], [-0.4, -0.5, 1.5], [1.2, -0.8, 0.3],
        [-1.3, -0.8, 0.3], [-1.7, -0.7, 0.8], [-1.3, -0.5, 1.5], [-1.3, 0.5, 1.5],
        [-1.7, -0.7, 1.0], [-1.7, 0.7, 1.0], [-1.7, -0.8, 0.3], [-1.7, 0.8, 0.3],
        [-0.4, 0.5, 1.5], [-1.7, 0.7, 0.8], [-1.3, 0.8, 0.3], [1.2, 0.8, 0.3],
        [-1.8, -0.2, 0.6], [-1.8, 0.2, 0.6], [0.6, -0.8, 1.0], [0.6, 0.8, 1.0]
    ],
    "vehicle.mini.cooper_s": [
        [0.2, 0.6, 1.4], [0.2, -0.6, 1.4], [1.6, 0.7, 0.8], [1.6, -0.7, 0.8],
        [1.8, 0.8, 0.3], [1.8, -0.8, 0.3], [-0.7, -0.6, 1.4], [1.1, -0.9, 0.3],
        [-1.3, -0.9, 0.3], [-1.8, -0.7, 0.6], [-1.3, -0.5, 1.4], [-1.3, 0.5, 1.4],
        [-1.7, -0.7, 0.9], [-1.7, 0.7, 0.9], [-1.9, -0.9, 0.3], [-1.9, 0.9, 0.3],
        [-0.7, 0.6, 1.4], [-1.8, 0.7, 0.6], [-1.3, 0.9, 0.3], [1.1, 0.9, 0.3],
        [-1.8, -0.3, 0.8], [-1.8, 0.3, 0.8], [0.3, -0.9, 1.1], [0.3, 0.9, 1.1]
    ]
}

size_car = {
    "vehicle.audi.a2": {
        "length": 3.705369472503662,
        "width": 1.788678526878357,
        "height": 1.549050211906433
    },
    "vehicle.citroen.c3": {
        "length": 3.987684965133667,
        "width": 1.8508483171463013,
        "height": 1.6171095371246338
    },
    "vehicle.chevrolet.impala": {
        "length": 5.357479572296143,
        "width": 2.033202886581421,
        "height": 1.4106587171554565
    },
    "vehicle.dodge.charger_police_2020": {
        "length": 5.237514495849609,
        "width": 1.9297595024108887,
        "height": 1.638383150100708
    },
    "vehicle.micro.microlino": {
        "length": 2.2072951793670654,
        "width": 1.4809197187423706,
        "height": 1.3760247230529785
    },
    "vehicle.dodge.charger_police": {
        "length": 4.974244117736816,
        "width": 2.0384011268615723,
        "height": 1.5421181917190552
    },
    "vehicle.audi.tt": {
        "length": 4.181210041046143,
        "width": 1.9941171407699585,
        "height": 1.385296106338501
    },
    "vehicle.jeep.wrangler_rubicon": {
        "length": 3.866220712661743,
        "width": 1.9051965475082397,
        "height": 1.8779358863830566
    },
    "vehicle.mercedes.coupe": {
        "length": 5.0267767906188965,
        "width": 2.1515462398529053,
        "height": 1.6506516933441162
    },
    "vehicle.mercedes.coupe_2020": {
        "length": 4.673638820648193,
        "width": 1.8118125200271606,
        "height": 1.441947340965271
    },
    "vehicle.dodge.charger_2020": {
        "length": 5.0078253746032715,
        "width": 1.8816219568252563,
        "height": 1.5347249507904053
    },
    "vehicle.ford.ambulance": {
        "length": 6.36564302444458,
        "width": 2.3511743545532227,
        "height": 2.431375741958618
    },
    "vehicle.lincoln.mkz_2020": {
        "length": 4.89238166809082,
        "width": 1.8367133140563965,
        "height": 1.490277647972107
    },
    "vehicle.mini.cooper_s_2021": {
        "length": 4.552699089050293,
        "width": 2.097072124481201,
        "height": 1.7671663761138916
    },
    "vehicle.toyota.prius": {
        "length": 4.513522624969482,
        "width": 2.006814479827881,
        "height": 1.5248334407806396
    },
    "vehicle.ford.crown": {
        "length": 5.365678787231445,
        "width": 1.8007241487503052,
        "height": 1.5749659538269043
    },
    "vehicle.carlamotors.carlacola": {
        "length": 5.203838348388672,
        "width": 2.6269896030426025,
        "height": 2.467444658279419
    },
    "vehicle.nissan.patrol_2021": {
        "length": 5.565828800201416,
        "width": 2.1499669551849365,
        "height": 2.045147180557251
    },
    "vehicle.mercedes.sprinter": {
        "length": 5.91519021987915,
        "width": 1.9884328842163086,
        "height": 2.560655355453491
    },
    "vehicle.audi.etron": {
        "length": 4.855708599090576,
        "width": 2.0327565670013428,
        "height": 1.6493593454360962
    },
    "vehicle.seat.leon": {
        "length": 4.1928300857543945,
        "width": 1.8161858320236206,
        "height": 1.4738311767578125
    },
    "vehicle.volkswagen.t2_2021": {
        "length": 4.442183971405029,
        "width": 1.77456533908844,
        "height": 1.9872066974639893
    },
    "vehicle.tesla.cybertruck": {
        "length": 6.273553371429443,
        "width": 2.3895740509033203,
        "height": 2.098191261291504
    },
    "vehicle.lincoln.mkz_2017": {
        "length": 4.901683330535889,
        "width": 2.128324270248413,
        "height": 1.5107464790344238
    },
    "vehicle.ford.mustang": {
        "length": 4.717525005340576,
        "width": 1.894826889038086,
        "height": 1.300939917564392
    },
    "vehicle.carlamotors.firetruck": {
        "length": 8.46804141998291,
        "width": 2.8910882472991943,
        "height": 3.8274123668670654
    },
    "vehicle.volkswagen.t2": {
        "length": 4.4804368019104,
        "width": 2.069315195083618,
        "height": 2.0377919673919678
    },
    "vehicle.mitsubishi.fusorosa": {
        "length": 10.272685050964355,
        "width": 3.9441518783569336,
        "height": 4.252848148345947
    },
    "vehicle.tesla.model3": {
        "length": 4.791779518127441,
        "width": 2.163450002670288,
        "height": 1.4876600503921509
    },
    "vehicle.bmw.grandtourer": {
        "length": 4.611005783081055,
        "width": 2.241713285446167,
        "height": 1.6672759056091309
    },
    "vehicle.nissan.patrol": {
        "length": 4.6045098304748535,
        "width": 1.9315929412841797,
        "height": 1.8548461198806763
    },
    "vehicle.nissan.micra": {
        "length": 3.633375883102417,
        "width": 1.845113754272461,
        "height": 1.5012825727462769
    },
    "vehicle.mini.cooper_s": {
        "length": 3.805800199508667,
        "width": 1.970275640487671,
        "height": 1.4750301837921143
    }
}

# Extend car keypoints with 8 corner points
world_car_ext = copy.deepcopy(world_car)
for name, kps in world_car_ext.items():
    l = size_car[name]['length']
    w = size_car[name]['width']
    h = size_car[name]['height']

    kps.append([l/2, w/2, 0])
    kps.append([-l/2, w/2, 0])
    kps.append([-l/2, -w/2, 0])
    kps.append([l/2, -w/2, 0])
    kps.append([l/2, w/2, h])
    kps.append([-l/2, w/2, h])
    kps.append([-l/2, -w/2, h])
    kps.append([l/2, -w/2, h])

# skeleton line of keypoints
skeleton = np.array([
    [1, 17], [1, 2], [1, 3], [2, 4], [2, 7], [3, 4],
    [3, 5], [4, 6], [5, 6], [6, 8],
    [8, 9], [7, 10], [9, 10], [10, 13], [18, 14],
    [23, 7], [23, 8], [23, 9], [8, 4], [23, 4], [23, 2],
    [11, 12], [11, 13], [11, 7], [13, 14], [13, 15],
    [12, 14], [12, 17], [14, 16], [15, 16],
    [21, 22], [21, 13], [21, 15], [21, 9], [22, 16],
    [22, 14], [22, 19], [16, 19], [15, 9],
    [18, 19], [18, 17], [19, 20], [20, 5], [17, 24], [24, 19],
    [24, 1], [20, 3], [24, 3], [24, 20],
    [25, 26], [26, 27], [27, 28], [28, 25],
    [29, 30], [30, 31], [31, 32], [32, 29],
    [25, 29], [26, 30], [27, 31], [28, 32],
    [5, 25], [16, 26], [15, 27], [6, 28],
    [1, 29], [12, 30], [11, 31], [2, 32]
]) - 1